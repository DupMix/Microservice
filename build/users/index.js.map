{"version":3,"sources":["../../src/users/index.js"],"names":["getAuthToken","request","response","next","authorization","headers","authParts","split","authToken","checkIfAuthenticated","admin","auth","verifyIdToken","userInfo","authId","uid","status","send","error"],"mappings":";;;;;;;AAAA;;;;;;;;AAEA,IAAMA,YAAY,GAAG,SAAfA,YAAe,CAACC,OAAD,EAAUC,QAAV,EAAoBC,IAApB,EAA6B;AAChD,MAAQC,aAAR,GAA0BH,OAAO,CAACI,OAAlC,CAAQD,aAAR;AACA,MAAME,SAAS,GAAGF,aAAa,GAAGA,aAAa,CAACG,KAAd,CAAoB,GAApB,CAAH,GAA8B,EAA7D;;AACA,MAAID,SAAS,CAAC,CAAD,CAAT,KAAiB,QAArB,EAA+B;AAC7BL,IAAAA,OAAO,CAACO,SAAR,GAAoBF,SAAS,CAAC,CAAD,CAA7B;AACD,GAFD,MAEO;AACLL,IAAAA,OAAO,CAACO,SAAR,GAAoB,IAApB;AACD;;AACDL,EAAAA,IAAI;AACL,CATD;;AAWO,IAAMM,oBAAoB,GAAG,SAAvBA,oBAAuB,CAACR,OAAD,EAAUC,QAAV,EAAoBC,IAApB,EAA6B;AAC/DH,EAAAA,YAAY,CAACC,OAAD,EAAUC,QAAV,uEAAoB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEpBM,YAAAA,SAFoB,GAENP,OAFM,CAEpBO,SAFoB;AAAA;AAAA,mBAGLE,kBACpBC,IADoB,GAEpBC,aAFoB,CAENJ,SAFM,CAHK;;AAAA;AAGtBK,YAAAA,QAHsB;AAM5BZ,YAAAA,OAAO,CAACa,MAAR,GAAiBD,QAAQ,CAACE,GAA1B;AAN4B,6CAOrBZ,IAAI,EAPiB;;AAAA;AAAA;AAAA;AAAA,6CASrBD,QAAQ,CAACc,MAAT,CAAgB,GAAhB,EAAqBC,IAArB,CAA0B;AAC/BC,cAAAA,KAAK,EAAE;AADwB,aAA1B,CATqB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAApB,GAAZ;AAcD,CAfM","sourcesContent":["import admin from '../firebase/admin'\n\nconst getAuthToken = (request, response, next) => {\n  const { authorization } = request.headers\n  const authParts = authorization ? authorization.split(' ') : []\n  if (authParts[0] === 'Bearer') {\n    request.authToken = authParts[1]\n  } else {\n    request.authToken = null\n  }\n  next()\n}\n\nexport const checkIfAuthenticated = (request, response, next) => {\n  getAuthToken(request, response, async () => {\n    try {\n      const { authToken } = request\n      const userInfo = await admin\n        .auth()\n        .verifyIdToken(authToken)\n      request.authId = userInfo.uid\n      return next()\n    } catch (error) {\n      return response.status(401).send({ \n        error: 'You are not authorized to make this request'\n      })\n    }\n  })\n}\n"],"file":"index.js"}